---
created: 2025-09-20T03:46:14Z
last_updated: 2025-09-20T05:52:55Z
version: 1.2
author: Claude Code PM System
---

# 系统模式

## 架构模式

### 命令模式
- **描述**: 所有功能都作为命令暴露
- **实现**: 每个命令在单独的 markdown 文件中
- **优势**: 模块化、易于扩展、清晰的接口

### 代理模式
- **描述**: 为不同任务类型专门化的 AI 代理
- **类型**:
  - file-analyzer: 用于读取和总结文件
  - code-analyzer: 用于代码分析和错误检测
  - test-runner: 用于执行和分析测试
  - parallel-worker: 用于协调并行工作流
- **优势**: 上下文隔离、专业化技能

### 上下文持久化模式
- **描述**: 在会话间维护项目状态
- **实现**: .claude/context/ 目录中的结构化文件
- **优势**: 无上下文丢失、快速重启

## 设计模式

### 规范驱动开发
- **模式**: 所有工作都从书面规范开始
- **流程**: PRD → 史诗 → 任务 → 问题 → 代码
- **强制**: 不允许"凭感觉编码"

### GitHub 作为数据库模式
- **描述**: 使用 GitHub Issues 作为主要数据存储
- **优势**:
  - 原生协作
  - 内置审计跟踪
  - 团队透明度
  - 无需单独数据库

### 并行执行模式
- **描述**: 多个代理同时工作
- **实现**: 使用 Git worktrees 进行隔离
- **优势**: 更快的交付、冲突预防
- **实践**:
  - 主仓库保存系统文件
  - 开发worktree用于具体任务实现
  - 通过GitHub Issues协调工作

### 依赖管理模式
- **描述**: 系统化的依赖包管理
- **实现**: package.json + package-lock.json
- **优势**: 版本锁定、可重现构建

### 配置即代码模式
- **描述**: 所有配置都在版本控制中
- **实现**: ESLint、Prettier、Husky 配置文件
- **优势**: 团队一致性、自动化检查

## 数据流模式

### 线性进展流程
```
PRD 创建 → 实现规划 → 任务分解 → GitHub 同步 → 并行执行
```

### 上下文加载流程
1. 加载 .claude/context/ 文件
2. 加载史诗特定上下文
3. 加载任务特定需求
4. 在完整上下文中执行

### 双向同步流程
- **本地 → GitHub**: 进度更新、完成状态
- **GitHub → 本地**: 问题分配、优先级变更

### API 响应模式
- **描述**: 统一的 API 响应格式
- **实现**: ApiResponseBuilder 工具类
- **优势**: 一致的客户端体验、易于错误处理

### 错误处理模式
- **描述**: 集中化的错误处理机制
- **实现**: withErrorHandler 包装器
- **优势**: 统一日志记录、优雅降级

## 文件组织模式

### 约定优于配置
- **模式**: 标准化的文件和目录名称
- **示例**: .claude/epics/[name]/epic.md
- **优势**: 可预测、无需配置

### Markdown 作为通用格式
- **模式**: 所有文档使用 markdown
- **优势**: 人类可读、版本控制友好

### 前置元数据
- **模式**: 上下文文件中的 YAML 前置元数据
- **优势**: 结构化数据、易于解析

## 工作流模式

### 五阶段纪律
1. **头脑风暴**: 深入思考需求
2. **文档化**: 编写全面规范
3. **规划**: 技术架构
4. **执行**: 按规范构建
5. **跟踪**: 透明进度

### 快速失败模式
- **关键配置**: 缺少必需项时立即失败
- **可选功能**: 优雅降级
- **用户体验**: 清晰的错误消息

## 避免的反模式

### 无上下文切换
- **问题**: 会话间丢失上下文
- **解决方案**: 持久化上下文文件

### 无串行瓶颈
- **问题**: 一次一个任务减缓交付
- **解决方案**: 并行代理执行

### 无隐藏状态
- **问题**: 完成前进度不可见
- **解决方案**: 实时 GitHub 更新

### 无凭感觉编码
- **问题**: 无规范凭记忆构建
- **解决方案**: 强制规范阶段

## 集成模式

### 松耦合
- **模式**: 组件独立工作
- **实现**: 清晰的接口、基于文件的通信

### 显式同步
- **模式**: 手动同步操作
- **优势**: 可控、可审计、无意外

### 工具不可知
- **模式**: 适用于任何编辑器/IDE
- **优势**: 无工具锁定